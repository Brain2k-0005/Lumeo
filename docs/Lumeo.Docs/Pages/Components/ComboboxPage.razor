@page "/components/combobox"

<PageTitle>Combobox — Lumeo</PageTitle>

<PageHeader Title="Combobox" Description="An autocomplete input with a filterable dropdown list." />

<div class="space-y-8">
    <ComponentDemo Title="Default" Code="@_defaultCode">
        <div class="w-full max-w-xs">
            <Combobox @bind-Value="_selectedFramework" @bind-IsOpen="_isOpen1">
                <ComboboxInput Placeholder="Search frameworks..." />
                <ComboboxContent>
                    @foreach (var fw in _frameworks.Where(f => string.IsNullOrEmpty(_searchText1) || f.Label.Contains(_searchText1, StringComparison.OrdinalIgnoreCase)))
                    {
                        <ComboboxItem Value="@fw.Value">@fw.Label</ComboboxItem>
                    }
                    <ComboboxEmpty>No framework found.</ComboboxEmpty>
                </ComboboxContent>
            </Combobox>
            @if (!string.IsNullOrEmpty(_selectedFramework))
            {
                <p class="text-sm text-muted-foreground mt-2">Selected: @_selectedFramework</p>
            }
        </div>
    </ComponentDemo>

    <ComponentDemo Title="Country Selector" Code="@_countryCode">
        <div class="w-full max-w-xs space-y-2">
            <Label>Country</Label>
            <Combobox @bind-Value="_selectedCountry" @bind-IsOpen="_isOpen3">
                <ComboboxInput Placeholder="Search countries..." />
                <ComboboxContent>
                    @foreach (var country in _countries)
                    {
                        <ComboboxItem Value="@country">@country</ComboboxItem>
                    }
                    <ComboboxEmpty>No country found.</ComboboxEmpty>
                </ComboboxContent>
            </Combobox>
            @if (!string.IsNullOrEmpty(_selectedCountry))
            {
                <p class="text-sm text-muted-foreground">Selected: @_selectedCountry</p>
            }
        </div>
    </ComponentDemo>

    <ComponentDemo Title="With Label" Code="@_labelCode">
        <div class="w-full max-w-xs space-y-2">
            <Label>Language</Label>
            <Combobox @bind-Value="_selectedLanguage" @bind-IsOpen="_isOpen2">
                <ComboboxInput Placeholder="Search languages..." />
                <ComboboxContent>
                    @foreach (var lang in _languages)
                    {
                        <ComboboxItem Value="@lang">@lang</ComboboxItem>
                    }
                    <ComboboxEmpty>No language found.</ComboboxEmpty>
                </ComboboxContent>
            </Combobox>
        </div>
    </ComponentDemo>
</div>

@code {
    private string? _selectedFramework;
    private string? _selectedLanguage;
    private string? _selectedCountry;
    private bool _isOpen1;
    private bool _isOpen2;
    private bool _isOpen3;
    private string _searchText1 = "";

    private readonly string[] _countries = ["Australia", "Canada", "France", "Germany", "India", "Japan", "Netherlands", "United Kingdom", "United States"];

    private record FrameworkOption(string Value, string Label);

    private readonly FrameworkOption[] _frameworks =
    [
        new("blazor", "Blazor"),
        new("react", "React"),
        new("vue", "Vue.js"),
        new("angular", "Angular"),
        new("svelte", "Svelte"),
    ];

    private readonly string[] _languages = ["C#", "TypeScript", "Python", "Rust", "Go"];

    private string _defaultCode = @"<Combobox @bind-Value=""_selected"" @bind-IsOpen=""_isOpen"">
    <ComboboxInput Placeholder=""Search frameworks..."" />
    <ComboboxContent>
        <ComboboxItem Value=""blazor"">Blazor</ComboboxItem>
        <ComboboxItem Value=""react"">React</ComboboxItem>
        <ComboboxItem Value=""vue"">Vue.js</ComboboxItem>
        <ComboboxEmpty>No framework found.</ComboboxEmpty>
    </ComboboxContent>
</Combobox>";

    private string _countryCode = @"<Label>Country</Label>
<Combobox @bind-Value=""_selected"" @bind-IsOpen=""_isOpen"">
    <ComboboxInput Placeholder=""Search countries..."" />
    <ComboboxContent>
        <ComboboxItem Value=""Australia"">Australia</ComboboxItem>
        <ComboboxItem Value=""Canada"">Canada</ComboboxItem>
        <ComboboxItem Value=""France"">France</ComboboxItem>
        <ComboboxItem Value=""United Kingdom"">United Kingdom</ComboboxItem>
        <ComboboxItem Value=""United States"">United States</ComboboxItem>
        <ComboboxEmpty>No country found.</ComboboxEmpty>
    </ComboboxContent>
</Combobox>";

    private string _labelCode = @"<Label>Language</Label>
<Combobox @bind-Value=""_selected"" @bind-IsOpen=""_isOpen"">
    <ComboboxInput Placeholder=""Search languages..."" />
    <ComboboxContent>
        <ComboboxItem Value=""C#"">C#</ComboboxItem>
        <ComboboxItem Value=""TypeScript"">TypeScript</ComboboxItem>
        <ComboboxEmpty>No language found.</ComboboxEmpty>
    </ComboboxContent>
</Combobox>";
}

<!-- API Reference -->
<div class="mt-12 space-y-6">
    <h2 class="text-2xl font-bold text-foreground">API Reference</h2>

    <div class="space-y-8">
        <div>
            <h3 class="text-lg font-semibold text-foreground mb-3">Combobox</h3>
            <div class="rounded-lg border border-border overflow-hidden">
                <table class="w-full text-sm">
                    <thead>
                        <tr class="border-b bg-muted/40">
                            <th class="text-left p-3 font-medium text-foreground">Property</th>
                            <th class="text-left p-3 font-medium text-foreground">Type</th>
                            <th class="text-left p-3 font-medium text-foreground">Default</th>
                            <th class="text-left p-3 font-medium text-foreground">Description</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-border/40">
                        <tr>
                            <td class="p-3 font-mono text-xs text-primary">Value</td>
                            <td class="p-3 font-mono text-xs text-muted-foreground">string?</td>
                            <td class="p-3 font-mono text-xs text-muted-foreground">null</td>
                            <td class="p-3 text-muted-foreground">The currently selected value. Use with @@bind-Value for two-way binding.</td>
                        </tr>
                        <tr>
                            <td class="p-3 font-mono text-xs text-primary">ValueChanged</td>
                            <td class="p-3 font-mono text-xs text-muted-foreground">EventCallback&lt;string&gt;</td>
                            <td class="p-3 font-mono text-xs text-muted-foreground">—</td>
                            <td class="p-3 text-muted-foreground">Callback invoked when the selected value changes.</td>
                        </tr>
                        <tr>
                            <td class="p-3 font-mono text-xs text-primary">IsOpen</td>
                            <td class="p-3 font-mono text-xs text-muted-foreground">bool</td>
                            <td class="p-3 font-mono text-xs text-muted-foreground">false</td>
                            <td class="p-3 text-muted-foreground">Controls whether the dropdown is open. Use with @@bind-IsOpen for two-way binding.</td>
                        </tr>
                        <tr>
                            <td class="p-3 font-mono text-xs text-primary">IsOpenChanged</td>
                            <td class="p-3 font-mono text-xs text-muted-foreground">EventCallback&lt;bool&gt;</td>
                            <td class="p-3 font-mono text-xs text-muted-foreground">—</td>
                            <td class="p-3 text-muted-foreground">Callback invoked when the open state changes.</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div>
            <h3 class="text-lg font-semibold text-foreground mb-3">ComboboxInput</h3>
            <div class="rounded-lg border border-border overflow-hidden">
                <table class="w-full text-sm">
                    <thead>
                        <tr class="border-b bg-muted/40">
                            <th class="text-left p-3 font-medium text-foreground">Property</th>
                            <th class="text-left p-3 font-medium text-foreground">Type</th>
                            <th class="text-left p-3 font-medium text-foreground">Default</th>
                            <th class="text-left p-3 font-medium text-foreground">Description</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-border/40">
                        <tr>
                            <td class="p-3 font-mono text-xs text-primary">Placeholder</td>
                            <td class="p-3 font-mono text-xs text-muted-foreground">string</td>
                            <td class="p-3 font-mono text-xs text-muted-foreground">"Search..."</td>
                            <td class="p-3 text-muted-foreground">Placeholder text shown in the search input when empty.</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div>
            <h3 class="text-lg font-semibold text-foreground mb-3">ComboboxItem</h3>
            <div class="rounded-lg border border-border overflow-hidden">
                <table class="w-full text-sm">
                    <thead>
                        <tr class="border-b bg-muted/40">
                            <th class="text-left p-3 font-medium text-foreground">Property</th>
                            <th class="text-left p-3 font-medium text-foreground">Type</th>
                            <th class="text-left p-3 font-medium text-foreground">Default</th>
                            <th class="text-left p-3 font-medium text-foreground">Description</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-border/40">
                        <tr>
                            <td class="p-3 font-mono text-xs text-primary">Value</td>
                            <td class="p-3 font-mono text-xs text-muted-foreground">string</td>
                            <td class="p-3 font-mono text-xs text-muted-foreground">""</td>
                            <td class="p-3 text-muted-foreground">The value this item represents when selected. Required. Also used for filtering against the search text.</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
