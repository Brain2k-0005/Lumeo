@page "/themes"

<PageTitle>Themes â€” Lumeo</PageTitle>

<!-- Break out of the container to achieve full-width layout -->
<div class="-mx-4 sm:-mx-6 -my-8 flex min-h-[calc(100vh-3.5rem)]">
    <!-- Preview Area (scrollable) -->
    <div class="flex-1 overflow-y-auto p-6 lg:p-8 space-y-6">
        <div class="max-w-4xl">
            <h1 class="text-3xl font-bold tracking-tight text-foreground">Themes</h1>
            <p class="text-muted-foreground mt-1">Customize the look and feel of your components.</p>
        </div>

        <div class="max-w-4xl space-y-6">
            <!-- Card Example -->
            <Card>
                <CardHeader>
                    <h3 class="text-lg font-semibold leading-none tracking-tight">Create project</h3>
                    <p class="text-sm text-muted-foreground">Deploy your new project in one-click.</p>
                </CardHeader>
                <CardContent>
                    <div class="space-y-4">
                        <div class="space-y-2">
                            <Label>Name</Label>
                            <Input placeholder="My awesome project" />
                        </div>
                        <div class="space-y-2">
                            <Label>Description</Label>
                            <Textarea placeholder="Describe your project..." />
                        </div>
                    </div>
                </CardContent>
                <CardFooter>
                    <div class="flex justify-between w-full">
                        <Button Variant="Button.ButtonVariant.Outline">Cancel</Button>
                        <Button>Deploy</Button>
                    </div>
                </CardFooter>
            </Card>

            <!-- Buttons -->
            <Card>
                <CardHeader>
                    <h3 class="text-lg font-semibold leading-none tracking-tight">Buttons</h3>
                </CardHeader>
                <CardContent>
                    <div class="flex flex-wrap gap-2">
                        <Button>Primary</Button>
                        <Button Variant="Button.ButtonVariant.Secondary">Secondary</Button>
                        <Button Variant="Button.ButtonVariant.Destructive">Destructive</Button>
                        <Button Variant="Button.ButtonVariant.Outline">Outline</Button>
                        <Button Variant="Button.ButtonVariant.Ghost">Ghost</Button>
                        <Button Variant="Button.ButtonVariant.Link">Link</Button>
                    </div>
                </CardContent>
            </Card>

            <!-- Form Controls -->
            <Card>
                <CardHeader>
                    <h3 class="text-lg font-semibold leading-none tracking-tight">Form Controls</h3>
                </CardHeader>
                <CardContent>
                    <div class="space-y-4">
                        <div class="flex items-center gap-6">
                            <div class="flex items-center gap-2">
                                <Switch @bind-Checked="_switch1" />
                                <Label>Airplane Mode</Label>
                            </div>
                            <div class="flex items-center gap-2">
                                <Checkbox @bind-Checked="_check1" />
                                <Label>Accept terms</Label>
                            </div>
                        </div>
                        <div class="w-full max-w-sm">
                            <Slider @bind-Value="_slider1" />
                        </div>
                        <div class="flex items-center gap-2">
                            <Toggle @bind-Pressed="_bold">
                                <Blazicon Svg="Lucide.Bold" class="h-4 w-4" />
                            </Toggle>
                            <Toggle @bind-Pressed="_italic">
                                <Blazicon Svg="Lucide.Italic" class="h-4 w-4" />
                            </Toggle>
                            <Toggle @bind-Pressed="_underline" Variant="Toggle.ToggleVariant.Outline">
                                <Blazicon Svg="Lucide.Underline" class="h-4 w-4" />
                            </Toggle>
                        </div>
                    </div>
                </CardContent>
            </Card>

            <!-- Badges & Progress -->
            <Card>
                <CardHeader>
                    <h3 class="text-lg font-semibold leading-none tracking-tight">Badges & Progress</h3>
                </CardHeader>
                <CardContent>
                    <div class="space-y-4">
                        <div class="flex flex-wrap gap-2">
                            <Badge>Default</Badge>
                            <Badge Variant="Badge.BadgeVariant.Secondary">Secondary</Badge>
                            <Badge Variant="Badge.BadgeVariant.Outline">Outline</Badge>
                            <Badge Variant="Badge.BadgeVariant.Destructive">Destructive</Badge>
                        </div>
                        <Progress Value="65" />
                    </div>
                </CardContent>
            </Card>

            <!-- Dialog Preview -->
            <Card>
                <CardHeader>
                    <h3 class="text-lg font-semibold leading-none tracking-tight">Dialog</h3>
                </CardHeader>
                <CardContent>
                    <Dialog @bind-IsOpen="_dialogOpen">
                        <DialogTrigger>
                            <Button Variant="Button.ButtonVariant.Outline">Open Dialog</Button>
                        </DialogTrigger>
                        <DialogContent>
                            <DialogHeader>
                                <DialogTitle>Edit profile</DialogTitle>
                                <DialogDescription>Make changes to your profile here. Click save when you're done.</DialogDescription>
                            </DialogHeader>
                            <div class="space-y-4 py-4">
                                <div class="space-y-2">
                                    <Label>Name</Label>
                                    <Input placeholder="Enter your name" />
                                </div>
                                <div class="space-y-2">
                                    <Label>Email</Label>
                                    <Input type="email" placeholder="Enter your email" />
                                </div>
                            </div>
                            <DialogFooter>
                                <DialogClose>
                                    <Button Variant="Button.ButtonVariant.Outline">Cancel</Button>
                                </DialogClose>
                                <Button>Save changes</Button>
                            </DialogFooter>
                        </DialogContent>
                    </Dialog>
                </CardContent>
            </Card>

            <!-- Accordion -->
            <Card>
                <CardHeader>
                    <h3 class="text-lg font-semibold leading-none tracking-tight">Accordion</h3>
                </CardHeader>
                <CardContent>
                    <Accordion>
                        <AccordionItem Value="item-1">
                            <AccordionTrigger>Is it accessible?</AccordionTrigger>
                            <AccordionContent>
                                <span class="text-sm text-muted-foreground">Yes. It adheres to the WAI-ARIA design pattern and supports keyboard navigation.</span>
                            </AccordionContent>
                        </AccordionItem>
                        <AccordionItem Value="item-2">
                            <AccordionTrigger>Is it styled?</AccordionTrigger>
                            <AccordionContent>
                                <span class="text-sm text-muted-foreground">Yes. It comes with default styles that match the other components' aesthetic.</span>
                            </AccordionContent>
                        </AccordionItem>
                        <AccordionItem Value="item-3">
                            <AccordionTrigger>Is it animated?</AccordionTrigger>
                            <AccordionContent>
                                <span class="text-sm text-muted-foreground">Yes. It uses CSS animations for smooth open and close transitions.</span>
                            </AccordionContent>
                        </AccordionItem>
                    </Accordion>
                </CardContent>
            </Card>

            <!-- Avatar Group -->
            <Card>
                <CardHeader>
                    <h3 class="text-lg font-semibold leading-none tracking-tight">Avatars</h3>
                </CardHeader>
                <CardContent>
                    <div class="flex items-center gap-3">
                        <Avatar>
                            <AvatarFallback>JD</AvatarFallback>
                        </Avatar>
                        <Avatar>
                            <AvatarFallback>AB</AvatarFallback>
                        </Avatar>
                        <Avatar>
                            <AvatarFallback>MK</AvatarFallback>
                        </Avatar>
                        <Avatar Size="Avatar.AvatarSize.Sm">
                            <AvatarFallback>
                                <Blazicon Svg="Lucide.User" class="h-4 w-4" />
                            </AvatarFallback>
                        </Avatar>
                        <Avatar Size="Avatar.AvatarSize.Lg">
                            <AvatarFallback>LG</AvatarFallback>
                        </Avatar>
                    </div>
                </CardContent>
            </Card>

            <!-- Alerts -->
            <Card>
                <CardHeader>
                    <h3 class="text-lg font-semibold leading-none tracking-tight">Alerts</h3>
                </CardHeader>
                <CardContent>
                    <div class="space-y-3">
                        <Alert>
                            <div class="flex items-start gap-3">
                                <Blazicon Svg="Lucide.Bell" class="h-4 w-4 mt-0.5" />
                                <div>
                                    <p class="font-medium leading-none tracking-tight mb-1">Heads up!</p>
                                    <p class="text-sm text-muted-foreground">You can add components to your app using the CLI.</p>
                                </div>
                            </div>
                        </Alert>
                        <Alert Variant="Alert.AlertVariant.Destructive">
                            <div class="flex items-start gap-3">
                                <Blazicon Svg="Lucide.X" class="h-4 w-4 mt-0.5" />
                                <div>
                                    <p class="font-medium leading-none tracking-tight mb-1">Error</p>
                                    <p class="text-sm">Your session has expired. Please log in again.</p>
                                </div>
                            </div>
                        </Alert>
                    </div>
                </CardContent>
            </Card>

            <!-- Skeleton Preview -->
            <Card>
                <CardHeader>
                    <h3 class="text-lg font-semibold leading-none tracking-tight">Skeleton</h3>
                </CardHeader>
                <CardContent>
                    <div class="flex items-center space-x-4">
                        <Skeleton Class="h-12 w-12 rounded-full" />
                        <div class="space-y-2">
                            <Skeleton Class="h-4 w-[250px]" />
                            <Skeleton Class="h-4 w-[200px]" />
                        </div>
                    </div>
                </CardContent>
            </Card>

            <!-- Tooltip Demo -->
            <Card>
                <CardHeader>
                    <h3 class="text-lg font-semibold leading-none tracking-tight">Tooltip</h3>
                </CardHeader>
                <CardContent>
                    <div class="flex gap-4">
                        <Tooltip>
                            <TooltipTrigger>
                                <Button Variant="Button.ButtonVariant.Outline">
                                    <Blazicon Svg="Lucide.Plus" class="h-4 w-4" />
                                </Button>
                            </TooltipTrigger>
                            <TooltipContent>Add to library</TooltipContent>
                        </Tooltip>
                        <Tooltip>
                            <TooltipTrigger>
                                <Button Variant="Button.ButtonVariant.Outline">
                                    <Blazicon Svg="Lucide.Settings" class="h-4 w-4" />
                                </Button>
                            </TooltipTrigger>
                            <TooltipContent Side="TooltipContent.TooltipSide.Bottom">Settings</TooltipContent>
                        </Tooltip>
                        <Tooltip>
                            <TooltipTrigger>
                                <Button Variant="Button.ButtonVariant.Outline">
                                    <Blazicon Svg="Lucide.Heart" class="h-4 w-4" />
                                </Button>
                            </TooltipTrigger>
                            <TooltipContent Side="TooltipContent.TooltipSide.Right">Favorite</TooltipContent>
                        </Tooltip>
                    </div>
                </CardContent>
            </Card>

            <!-- Typography Preview -->
            <Card>
                <CardHeader>
                    <h3 class="text-lg font-semibold leading-none tracking-tight">Typography</h3>
                </CardHeader>
                <CardContent>
                    <div class="space-y-4">
                        <h1 class="scroll-m-20 text-4xl font-extrabold tracking-tight text-foreground">Heading 1</h1>
                        <h2 class="scroll-m-20 text-3xl font-semibold tracking-tight text-foreground">Heading 2</h2>
                        <h3 class="scroll-m-20 text-2xl font-semibold tracking-tight text-foreground">Heading 3</h3>
                        <h4 class="scroll-m-20 text-xl font-semibold tracking-tight text-foreground">Heading 4</h4>
                        <Separator />
                        <p class="leading-7 text-foreground">
                            The king, seeing how much happier his subjects were, realized the error of
                            his ways and repealed the taxes on laughter and joy.
                        </p>
                        <p class="text-sm text-muted-foreground">
                            This is muted text typically used for descriptions and secondary information.
                        </p>
                        <p class="text-foreground">
                            Visit the <a href="#" class="font-medium text-primary underline underline-offset-4">documentation</a> for more details.
                        </p>
                        <p class="text-xs text-muted-foreground">Small text for captions and footnotes.</p>
                        <p class="text-sm text-foreground">
                            Use the <code class="relative rounded bg-muted px-[0.3rem] py-[0.2rem] font-mono text-sm">install</code> command to add components.
                        </p>
                    </div>
                </CardContent>
            </Card>

            <!-- Tabs -->
            <Tabs ActiveValue="tab1">
                <TabsList>
                    <TabsTrigger Value="tab1">Account</TabsTrigger>
                    <TabsTrigger Value="tab2">Password</TabsTrigger>
                    <TabsTrigger Value="tab3">Settings</TabsTrigger>
                </TabsList>
                <TabsContent Value="tab1">
                    <Card>
                        <CardHeader>
                            <h3 class="text-lg font-semibold leading-none tracking-tight">Account</h3>
                            <p class="text-sm text-muted-foreground">Make changes to your account here.</p>
                        </CardHeader>
                        <CardContent>
                            <div class="space-y-2">
                                <Label>Username</Label>
                                <Input Value="@("@@lumeo")" />
                            </div>
                        </CardContent>
                        <CardFooter>
                            <Button>Save changes</Button>
                        </CardFooter>
                    </Card>
                </TabsContent>
                <TabsContent Value="tab2">
                    <Card>
                        <CardHeader>
                            <h3 class="text-lg font-semibold leading-none tracking-tight">Password</h3>
                            <p class="text-sm text-muted-foreground">Change your password here.</p>
                        </CardHeader>
                        <CardContent>
                            <div class="space-y-2">
                                <Label>Current password</Label>
                                <Input type="password" />
                            </div>
                        </CardContent>
                        <CardFooter>
                            <Button>Update password</Button>
                        </CardFooter>
                    </Card>
                </TabsContent>
                <TabsContent Value="tab3">
                    <Card>
                        <CardHeader>
                            <h3 class="text-lg font-semibold leading-none tracking-tight">Settings</h3>
                            <p class="text-sm text-muted-foreground">Configure your preferences.</p>
                        </CardHeader>
                    </Card>
                </TabsContent>
            </Tabs>
        </div>
    </div>

    <!-- Customizer Sidebar -->
    <aside class="w-72 shrink-0 border-l bg-card/50 sticky top-14 h-[calc(100vh-3.5rem)] overflow-y-auto hidden lg:block">
        <div class="p-4 border-b">
            <div class="flex items-center gap-2">
                <Blazicon Svg="Lucide.Palette" class="h-4 w-4 text-foreground" />
                <span class="font-semibold text-sm text-foreground">Customize</span>
            </div>
            <p class="text-xs text-muted-foreground mt-1">Adjust component styles</p>
        </div>

        <div class="divide-y divide-border">
            <!-- Preset -->
            <div>
                <button class="w-full flex items-center justify-between px-4 py-3 hover:bg-accent/50 transition-colors text-left"
                        @onclick='() => ToggleSection("preset")'>
                    <div>
                        <p class="text-xs text-muted-foreground">Preset</p>
                        <p class="text-sm font-semibold text-foreground">@GetActivePresetName()</p>
                    </div>
                    <span class="h-5 w-5 rounded-full bg-primary"></span>
                </button>
                @if (_expandedSection == "preset")
                {
                    <div class="px-4 py-2 bg-accent/30 space-y-1">
                        @foreach (var preset in _presets)
                        {
                            <button class="@($"w-full flex items-center gap-3 rounded-md px-2 py-1.5 text-sm hover:bg-accent transition-colors {(preset.Name == GetActivePresetName() ? "bg-accent" : "")}")"
                                    @onclick="() => ApplyPreset(preset)">
                                <span class="h-3.5 w-3.5 rounded-full" style="background: @preset.Preview"></span>
                                <span class="text-foreground">@preset.Name</span>
                                @if (preset.Name == GetActivePresetName())
                                {
                                    <Blazicon Svg="Lucide.Check" class="h-3.5 w-3.5 ml-auto text-foreground" />
                                }
                            </button>
                        }
                    </div>
                }
            </div>

            <!-- Style -->
            <div>
                <button class="w-full flex items-center justify-between px-4 py-3 hover:bg-accent/50 transition-colors text-left"
                        @onclick='() => ToggleSection("style")'>
                    <div>
                        <p class="text-xs text-muted-foreground">Style</p>
                        <p class="text-sm font-semibold text-foreground">@(_activeStyle == "new-york" ? "New York" : "Default")</p>
                    </div>
                    <Blazicon Svg="Lucide.Circle" class="h-5 w-5 text-muted-foreground" />
                </button>
                @if (_expandedSection == "style")
                {
                    <div class="px-4 py-2 bg-accent/30 space-y-1">
                        @foreach (var style in _styles)
                        {
                            <button class="@($"w-full flex items-center gap-3 rounded-md px-2 py-1.5 text-sm hover:bg-accent transition-colors {(style.Value == _activeStyle ? "bg-accent" : "")}")"
                                    @onclick="() => SetStyle(style.Value)">
                                <span class="text-foreground">@style.Name</span>
                                @if (style.Value == _activeStyle)
                                {
                                    <Blazicon Svg="Lucide.Check" class="h-3.5 w-3.5 ml-auto text-foreground" />
                                }
                            </button>
                        }
                    </div>
                }
            </div>

            <!-- Base Color -->
            <div>
                <button class="w-full flex items-center justify-between px-4 py-3 hover:bg-accent/50 transition-colors text-left"
                        @onclick='() => ToggleSection("baseColor")'>
                    <div>
                        <p class="text-xs text-muted-foreground">Base Color</p>
                        <p class="text-sm font-semibold text-foreground">@GetActiveBaseColorName()</p>
                    </div>
                    <span class="h-5 w-5 rounded-full" style="background: @GetActiveBaseColorPreview()"></span>
                </button>
                @if (_expandedSection == "baseColor")
                {
                    <div class="px-4 py-2 bg-accent/30 space-y-1">
                        @foreach (var color in _baseColors)
                        {
                            <button class="@($"w-full flex items-center gap-3 rounded-md px-2 py-1.5 text-sm hover:bg-accent transition-colors {(color.Value == _activeBaseColor ? "bg-accent" : "")}")"
                                    @onclick="() => SetBaseColor(color.Value)">
                                <span class="h-3.5 w-3.5 rounded-full" style="background: @color.Preview"></span>
                                <span class="text-foreground">@color.Name</span>
                                @if (color.Value == _activeBaseColor)
                                {
                                    <Blazicon Svg="Lucide.Check" class="h-3.5 w-3.5 ml-auto text-foreground" />
                                }
                            </button>
                        }
                    </div>
                }
            </div>

            <!-- Theme (Accent Color) -->
            <div>
                <button class="w-full flex items-center justify-between px-4 py-3 hover:bg-accent/50 transition-colors text-left"
                        @onclick='() => ToggleSection("theme")'>
                    <div>
                        <p class="text-xs text-muted-foreground">Theme</p>
                        <p class="text-sm font-semibold text-foreground">@GetActiveThemeName()</p>
                    </div>
                    <span class="h-5 w-5 rounded-full" style="background: @GetActiveThemePreview()"></span>
                </button>
                @if (_expandedSection == "theme")
                {
                    <div class="px-4 py-2 bg-accent/30 space-y-1">
                        @foreach (var theme in _themes)
                        {
                            <button class="@($"w-full flex items-center gap-3 rounded-md px-2 py-1.5 text-sm hover:bg-accent transition-colors {(theme.Value == _activeTheme ? "bg-accent" : "")}")"
                                    @onclick="() => SetTheme(theme.Value)">
                                <span class="h-3.5 w-3.5 rounded-full" style="background: @theme.Color"></span>
                                <span class="text-foreground">@theme.Name</span>
                                @if (theme.Value == _activeTheme)
                                {
                                    <Blazicon Svg="Lucide.Check" class="h-3.5 w-3.5 ml-auto text-foreground" />
                                }
                            </button>
                        }
                    </div>
                }
            </div>

            <!-- Radius -->
            <div>
                <button class="w-full flex items-center justify-between px-4 py-3 hover:bg-accent/50 transition-colors text-left"
                        @onclick='() => ToggleSection("radius")'>
                    <div>
                        <p class="text-xs text-muted-foreground">Radius</p>
                        <p class="text-sm font-semibold text-foreground">@GetActiveRadiusName()</p>
                    </div>
                    <Blazicon Svg="Lucide.CornerDownRight" class="h-5 w-5 text-muted-foreground" />
                </button>
                @if (_expandedSection == "radius")
                {
                    <div class="px-4 py-2 bg-accent/30 space-y-1">
                        @foreach (var radius in _radiiOptions)
                        {
                            <button class="@($"w-full flex items-center gap-3 rounded-md px-2 py-1.5 text-sm hover:bg-accent transition-colors {(radius.Value == _activeRadius ? "bg-accent" : "")}")"
                                    @onclick="() => SetRadius(radius.Value)">
                                <span class="inline-flex items-center justify-center h-3.5 w-3.5">
                                    <span class="h-3 w-3 border-2 border-foreground/40" style="border-radius: @(radius.Value)rem 0 0 0; border-right: none; border-bottom: none;"></span>
                                </span>
                                <span class="text-foreground">@radius.Name</span>
                                <span class="text-xs text-muted-foreground">@(radius.Value)rem</span>
                                @if (radius.Value == _activeRadius)
                                {
                                    <Blazicon Svg="Lucide.Check" class="h-3.5 w-3.5 ml-auto text-foreground" />
                                }
                            </button>
                        }
                    </div>
                }
            </div>

            <!-- Mode -->
            <div>
                <button class="w-full flex items-center justify-between px-4 py-3 hover:bg-accent/50 transition-colors text-left"
                        @onclick="ToggleDarkMode">
                    <div>
                        <p class="text-xs text-muted-foreground">Mode</p>
                        <p class="text-sm font-semibold text-foreground">@(_darkMode ? "Dark" : "Light")</p>
                    </div>
                    @if (_darkMode)
                    {
                        <Blazicon Svg="Lucide.Moon" class="h-5 w-5 text-muted-foreground" />
                    }
                    else
                    {
                        <Blazicon Svg="Lucide.Sun" class="h-5 w-5 text-muted-foreground" />
                    }
                </button>
            </div>

            <!-- Shuffle -->
            <div>
                <button class="w-full flex items-center justify-between px-4 py-3 hover:bg-accent/50 transition-colors text-left"
                        @onclick="ShuffleSettings">
                    <div>
                        <p class="text-xs text-muted-foreground">Shuffle</p>
                        <p class="text-sm font-semibold text-foreground">Try Random</p>
                    </div>
                    <span class="inline-flex items-center justify-center h-5 w-5 rounded-md bg-primary text-primary-foreground text-xs font-bold">R</span>
                </button>
            </div>

            <!-- Reset -->
            <div>
                <button class="w-full flex items-center justify-between px-4 py-3 hover:bg-accent/50 transition-colors text-left"
                        @onclick="ResetSettings">
                    <div>
                        <p class="text-xs text-muted-foreground">Reset</p>
                        <p class="text-sm font-semibold text-foreground">Start Over</p>
                    </div>
                    <Blazicon Svg="Lucide.RotateCcw" class="h-5 w-5 text-muted-foreground" />
                </button>
            </div>
        </div>

        <!-- Copy Theme (pinned to bottom) -->
        <div class="p-4 border-t mt-auto">
            <Button Variant="Button.ButtonVariant.Outline" Class="w-full" @onclick="CopyTheme">
                @if (_copied)
                {
                    <span class="flex items-center gap-2">
                        <Blazicon Svg="Lucide.Check" class="h-4 w-4" />
                        Copied!
                    </span>
                }
                else
                {
                    <span class="flex items-center gap-2">
                        <Blazicon Svg="Lucide.Copy" class="h-4 w-4" />
                        Copy Theme
                    </span>
                }
            </Button>
        </div>
    </aside>
</div>

@inject IJSRuntime JS

@code {
    private bool _switch1 = true;
    private bool _check1 = true;
    private double _slider1 = 50;
    private bool _bold, _italic, _underline;
    private bool _darkMode;
    private bool _dialogOpen;
    private bool _copied;
    private string _expandedSection = "";

    private string _activeTheme = "";
    private string _activeRadius = "0.75";
    private string _activeStyle = "default";
    private string _activeBaseColor = "slate";

    // --- Data records ---

    private record ThemeOption(string Name, string Value, string Color);
    private record StyleOption(string Name, string Value);
    private record BaseColorOption(string Name, string Value, string Preview);
    private record RadiusOption(string Name, string Value);
    private record PresetOption(string Name, string ThemeValue, string StyleValue, string BaseColorValue, string Preview);

    // --- Options ---

    private readonly ThemeOption[] _themes =
    [
        new("Orange", "", "hsl(14 70% 50%)"),
        new("Zinc", "zinc", "hsl(240 6% 10%)"),
        new("Blue", "blue", "hsl(221 83% 53%)"),
        new("Green", "green", "hsl(142 71% 45%)"),
        new("Rose", "rose", "hsl(346 77% 50%)"),
    ];

    private readonly StyleOption[] _styles =
    [
        new("Default", "default"),
        new("New York", "new-york"),
    ];

    private readonly BaseColorOption[] _baseColors =
    [
        new("Slate", "slate", "hsl(215 16% 47%)"),
        new("Gray", "gray", "hsl(220 9% 46%)"),
        new("Zinc", "zinc", "hsl(240 4% 46%)"),
        new("Neutral", "neutral", "hsl(0 0% 45%)"),
        new("Stone", "stone", "hsl(25 5% 45%)"),
    ];

    private readonly RadiusOption[] _radiiOptions =
    [
        new("None", "0"),
        new("Small", "0.25"),
        new("Default", "0.5"),
        new("Medium", "0.75"),
        new("Large", "1"),
    ];

    private readonly PresetOption[] _presets =
    [
        new("Default", "", "default", "slate", "hsl(14 70% 50%)"),
        new("Minimal", "zinc", "default", "zinc", "hsl(240 6% 10%)"),
        new("Vibrant", "blue", "new-york", "slate", "hsl(221 83% 53%)"),
        new("Warm", "rose", "default", "stone", "hsl(346 77% 50%)"),
        new("Forest", "green", "default", "gray", "hsl(142 71% 45%)"),
    ];

    // --- Helper methods ---

    private string GetActivePresetName()
    {
        foreach (var preset in _presets)
        {
            if (preset.ThemeValue == _activeTheme && preset.StyleValue == _activeStyle && preset.BaseColorValue == _activeBaseColor)
                return preset.Name;
        }
        return "Custom";
    }

    private string GetActiveThemeName()
    {
        foreach (var theme in _themes)
        {
            if (theme.Value == _activeTheme)
                return theme.Name;
        }
        return "Orange";
    }

    private string GetActiveThemePreview()
    {
        foreach (var theme in _themes)
        {
            if (theme.Value == _activeTheme)
                return theme.Color;
        }
        return "hsl(14 70% 50%)";
    }

    private string GetActiveBaseColorName()
    {
        foreach (var color in _baseColors)
        {
            if (color.Value == _activeBaseColor)
                return color.Name;
        }
        return "Slate";
    }

    private string GetActiveBaseColorPreview()
    {
        foreach (var color in _baseColors)
        {
            if (color.Value == _activeBaseColor)
                return color.Preview;
        }
        return "hsl(215 16% 47%)";
    }

    private string GetActiveRadiusName()
    {
        foreach (var radius in _radiiOptions)
        {
            if (radius.Value == _activeRadius)
                return radius.Name;
        }
        return _activeRadius + "rem";
    }

    // --- Section toggle ---

    private void ToggleSection(string section)
    {
        _expandedSection = _expandedSection == section ? "" : section;
    }

    // --- Apply preset ---

    private async Task ApplyPreset(PresetOption preset)
    {
        await SetTheme(preset.ThemeValue);
        await SetStyle(preset.StyleValue);
        await SetBaseColor(preset.BaseColorValue);
        _expandedSection = "";
    }

    // --- Setting methods ---

    private async Task SetStyle(string style)
    {
        _activeStyle = style;
        if (style == "new-york")
        {
            await JS.InvokeVoidAsync("eval", "document.documentElement.classList.add('style-new-york')");
        }
        else
        {
            await JS.InvokeVoidAsync("eval", "document.documentElement.classList.remove('style-new-york')");
        }
    }

    private async Task SetTheme(string theme)
    {
        _activeTheme = theme;
        var js = string.IsNullOrEmpty(theme)
            ? "document.documentElement.removeAttribute('data-theme')"
            : $"document.documentElement.setAttribute('data-theme', '{theme}')";
        await JS.InvokeVoidAsync("eval", js);
    }

    private async Task SetRadius(string radius)
    {
        _activeRadius = radius;
        await JS.InvokeVoidAsync("eval", $"document.documentElement.style.setProperty('--radius', '{radius}rem')");
    }

    private async Task SetBaseColor(string baseColor)
    {
        _activeBaseColor = baseColor;
        await JS.InvokeVoidAsync("eval", $"document.documentElement.setAttribute('data-base-color', '{baseColor}')");
    }

    private async Task ToggleDarkMode()
    {
        _darkMode = !_darkMode;
        await JS.InvokeVoidAsync("eval", _darkMode
            ? "document.documentElement.classList.add('dark')"
            : "document.documentElement.classList.remove('dark')");
    }

    private async Task ShuffleSettings()
    {
        var random = new Random();
        var themeIdx = random.Next(_themes.Length);
        var radiusIdx = random.Next(_radiiOptions.Length);
        var styleIdx = random.Next(_styles.Length);
        var baseColorIdx = random.Next(_baseColors.Length);

        await SetTheme(_themes[themeIdx].Value);
        await SetRadius(_radiiOptions[radiusIdx].Value);
        await SetStyle(_styles[styleIdx].Value);
        await SetBaseColor(_baseColors[baseColorIdx].Value);

        // Randomly toggle dark mode
        var shouldBeDark = random.Next(2) == 1;
        if (shouldBeDark != _darkMode)
        {
            await ToggleDarkMode();
        }

        _expandedSection = "";
    }

    private async Task ResetSettings()
    {
        await SetTheme("");
        await SetRadius("0.75");
        await SetStyle("default");
        await SetBaseColor("slate");

        if (_darkMode)
        {
            await ToggleDarkMode();
        }

        _expandedSection = "";
    }

    private async Task CopyTheme()
    {
        var themeLines = string.IsNullOrEmpty(_activeTheme)
            ? ""
            : $"\n/* Apply theme */\n[data-theme=\"{_activeTheme}\"] {{ /* Applied */ }}\n";
        var baseColorLine = _activeBaseColor != "slate"
            ? $"\n/* Base color */\n[data-base-color=\"{_activeBaseColor}\"] {{ /* Applied */ }}\n"
            : "";
        var styleLine = _activeStyle == "new-york"
            ? "\n/* Style: New York */\n.style-new-york { /* Applied */ }\n"
            : "";
        var css = $"/* Add to your CSS */\n@import \"lumeo/css/lumeo.css\";\n{themeLines}{baseColorLine}{styleLine}\n:root {{\n  --radius: {_activeRadius}rem;\n}}";
        await JS.InvokeVoidAsync("eval", $"navigator.clipboard.writeText({System.Text.Json.JsonSerializer.Serialize(css)})");
        _copied = true;
        StateHasChanged();
        await Task.Delay(2000);
        _copied = false;
        StateHasChanged();
    }
}
