@page "/themes"

<PageTitle>Themes — Lumeo</PageTitle>

<div class="-mx-4 sm:-mx-6 -my-8 flex min-h-[calc(100vh-3.5rem)]">
    <!-- Preview Area -->
    <div class="flex-1 overflow-y-auto p-6 lg:p-8">
        <div class="max-w-4xl space-y-6">
            <div>
                <h1 class="text-3xl font-bold tracking-tight text-foreground">Themes</h1>
                <p class="text-muted-foreground mt-1">Customize the look and feel of your components.</p>
            </div>

            <!-- Card Example -->
            <Card>
                <CardHeader>
                    <h3 class="text-lg font-semibold leading-none tracking-tight">Create project</h3>
                    <p class="text-sm text-muted-foreground">Deploy your new project in one-click.</p>
                </CardHeader>
                <CardContent>
                    <div class="space-y-4">
                        <div class="space-y-2">
                            <Label>Name</Label>
                            <Input placeholder="My awesome project" />
                        </div>
                        <div class="space-y-2">
                            <Label>Description</Label>
                            <Textarea placeholder="Describe your project..." />
                        </div>
                    </div>
                </CardContent>
                <CardFooter>
                    <div class="flex justify-between w-full">
                        <Button Variant="Button.ButtonVariant.Outline">Cancel</Button>
                        <Button>Deploy</Button>
                    </div>
                </CardFooter>
            </Card>

            <!-- Buttons -->
            <Card>
                <CardHeader>
                    <h3 class="text-lg font-semibold leading-none tracking-tight">Buttons</h3>
                </CardHeader>
                <CardContent>
                    <div class="flex flex-wrap gap-2">
                        <Button>Primary</Button>
                        <Button Variant="Button.ButtonVariant.Secondary">Secondary</Button>
                        <Button Variant="Button.ButtonVariant.Destructive">Destructive</Button>
                        <Button Variant="Button.ButtonVariant.Outline">Outline</Button>
                        <Button Variant="Button.ButtonVariant.Ghost">Ghost</Button>
                        <Button Variant="Button.ButtonVariant.Link">Link</Button>
                    </div>
                </CardContent>
            </Card>

            <!-- Form Controls -->
            <Card>
                <CardHeader>
                    <h3 class="text-lg font-semibold leading-none tracking-tight">Form Controls</h3>
                </CardHeader>
                <CardContent>
                    <div class="space-y-4">
                        <div class="flex items-center gap-6">
                            <div class="flex items-center gap-2">
                                <Switch @bind-Checked="_switch1" />
                                <Label>Airplane Mode</Label>
                            </div>
                            <div class="flex items-center gap-2">
                                <Checkbox @bind-Checked="_check1" />
                                <Label>Accept terms</Label>
                            </div>
                        </div>
                        <div class="w-full max-w-sm">
                            <Slider @bind-Value="_slider1" />
                        </div>
                        <div class="flex items-center gap-2">
                            <Toggle @bind-Pressed="_bold">
                                <Blazicon Svg="Lucide.Bold" class="h-4 w-4" />
                            </Toggle>
                            <Toggle @bind-Pressed="_italic">
                                <Blazicon Svg="Lucide.Italic" class="h-4 w-4" />
                            </Toggle>
                            <Toggle @bind-Pressed="_underline" Variant="Toggle.ToggleVariant.Outline">
                                <Blazicon Svg="Lucide.Underline" class="h-4 w-4" />
                            </Toggle>
                        </div>
                    </div>
                </CardContent>
            </Card>

            <!-- Badges & Progress -->
            <Card>
                <CardHeader>
                    <h3 class="text-lg font-semibold leading-none tracking-tight">Badges & Progress</h3>
                </CardHeader>
                <CardContent>
                    <div class="space-y-4">
                        <div class="flex flex-wrap gap-2">
                            <Badge>Default</Badge>
                            <Badge Variant="Badge.BadgeVariant.Secondary">Secondary</Badge>
                            <Badge Variant="Badge.BadgeVariant.Outline">Outline</Badge>
                            <Badge Variant="Badge.BadgeVariant.Destructive">Destructive</Badge>
                        </div>
                        <Progress Value="65" />
                    </div>
                </CardContent>
            </Card>

            <!-- Dialog Preview -->
            <Card>
                <CardHeader>
                    <h3 class="text-lg font-semibold leading-none tracking-tight">Dialog</h3>
                </CardHeader>
                <CardContent>
                    <Dialog @bind-IsOpen="_dialogOpen">
                        <DialogTrigger>
                            <Button Variant="Button.ButtonVariant.Outline">Open Dialog</Button>
                        </DialogTrigger>
                        <DialogContent>
                            <DialogHeader>
                                <DialogTitle>Edit profile</DialogTitle>
                                <DialogDescription>Make changes to your profile here. Click save when you're done.</DialogDescription>
                            </DialogHeader>
                            <div class="space-y-4 py-4">
                                <div class="space-y-2">
                                    <Label>Name</Label>
                                    <Input placeholder="Enter your name" />
                                </div>
                                <div class="space-y-2">
                                    <Label>Email</Label>
                                    <Input type="email" placeholder="Enter your email" />
                                </div>
                            </div>
                            <DialogFooter>
                                <DialogClose>
                                    <Button Variant="Button.ButtonVariant.Outline">Cancel</Button>
                                </DialogClose>
                                <Button>Save changes</Button>
                            </DialogFooter>
                        </DialogContent>
                    </Dialog>
                </CardContent>
            </Card>

            <!-- Accordion -->
            <Card>
                <CardHeader>
                    <h3 class="text-lg font-semibold leading-none tracking-tight">Accordion</h3>
                </CardHeader>
                <CardContent>
                    <Accordion>
                        <AccordionItem Value="item-1">
                            <AccordionTrigger>Is it accessible?</AccordionTrigger>
                            <AccordionContent>
                                <span class="text-sm text-muted-foreground">Yes. It adheres to the WAI-ARIA design pattern and supports keyboard navigation.</span>
                            </AccordionContent>
                        </AccordionItem>
                        <AccordionItem Value="item-2">
                            <AccordionTrigger>Is it styled?</AccordionTrigger>
                            <AccordionContent>
                                <span class="text-sm text-muted-foreground">Yes. It comes with default styles that match the other components' aesthetic.</span>
                            </AccordionContent>
                        </AccordionItem>
                        <AccordionItem Value="item-3">
                            <AccordionTrigger>Is it animated?</AccordionTrigger>
                            <AccordionContent>
                                <span class="text-sm text-muted-foreground">Yes. It uses CSS animations for smooth open and close transitions.</span>
                            </AccordionContent>
                        </AccordionItem>
                    </Accordion>
                </CardContent>
            </Card>

            <!-- Avatars -->
            <Card>
                <CardHeader>
                    <h3 class="text-lg font-semibold leading-none tracking-tight">Avatars</h3>
                </CardHeader>
                <CardContent>
                    <div class="flex items-center gap-3">
                        <Avatar><AvatarFallback>JD</AvatarFallback></Avatar>
                        <Avatar><AvatarFallback>AB</AvatarFallback></Avatar>
                        <Avatar><AvatarFallback>MK</AvatarFallback></Avatar>
                        <Avatar Size="Avatar.AvatarSize.Sm"><AvatarFallback><Blazicon Svg="Lucide.User" class="h-4 w-4" /></AvatarFallback></Avatar>
                        <Avatar Size="Avatar.AvatarSize.Lg"><AvatarFallback>LG</AvatarFallback></Avatar>
                    </div>
                </CardContent>
            </Card>

            <!-- Alerts -->
            <Card>
                <CardHeader>
                    <h3 class="text-lg font-semibold leading-none tracking-tight">Alerts</h3>
                </CardHeader>
                <CardContent>
                    <div class="space-y-3">
                        <Alert>
                            <div class="flex items-start gap-3">
                                <Blazicon Svg="Lucide.Bell" class="h-4 w-4 mt-0.5" />
                                <div>
                                    <p class="font-medium leading-none tracking-tight mb-1">Heads up!</p>
                                    <p class="text-sm text-muted-foreground">You can add components to your app using the CLI.</p>
                                </div>
                            </div>
                        </Alert>
                        <Alert Variant="Alert.AlertVariant.Destructive">
                            <div class="flex items-start gap-3">
                                <Blazicon Svg="Lucide.X" class="h-4 w-4 mt-0.5" />
                                <div>
                                    <p class="font-medium leading-none tracking-tight mb-1">Error</p>
                                    <p class="text-sm">Your session has expired. Please log in again.</p>
                                </div>
                            </div>
                        </Alert>
                    </div>
                </CardContent>
            </Card>

            <!-- Skeleton -->
            <Card>
                <CardHeader>
                    <h3 class="text-lg font-semibold leading-none tracking-tight">Skeleton</h3>
                </CardHeader>
                <CardContent>
                    <div class="flex items-center space-x-4">
                        <Skeleton Class="h-12 w-12 rounded-full" />
                        <div class="space-y-2">
                            <Skeleton Class="h-4 w-[250px]" />
                            <Skeleton Class="h-4 w-[200px]" />
                        </div>
                    </div>
                </CardContent>
            </Card>

            <!-- Tabs -->
            <Tabs ActiveValue="tab1">
                <TabsList>
                    <TabsTrigger Value="tab1">Account</TabsTrigger>
                    <TabsTrigger Value="tab2">Password</TabsTrigger>
                    <TabsTrigger Value="tab3">Settings</TabsTrigger>
                </TabsList>
                <TabsContent Value="tab1">
                    <Card>
                        <CardHeader>
                            <h3 class="text-lg font-semibold leading-none tracking-tight">Account</h3>
                            <p class="text-sm text-muted-foreground">Make changes to your account here.</p>
                        </CardHeader>
                        <CardContent>
                            <div class="space-y-2">
                                <Label>Username</Label>
                                <Input Value="@("@@lumeo")" />
                            </div>
                        </CardContent>
                        <CardFooter>
                            <Button>Save changes</Button>
                        </CardFooter>
                    </Card>
                </TabsContent>
                <TabsContent Value="tab2">
                    <Card>
                        <CardHeader>
                            <h3 class="text-lg font-semibold leading-none tracking-tight">Password</h3>
                            <p class="text-sm text-muted-foreground">Change your password here.</p>
                        </CardHeader>
                        <CardContent>
                            <div class="space-y-2">
                                <Label>Current password</Label>
                                <Input type="password" />
                            </div>
                        </CardContent>
                        <CardFooter>
                            <Button>Update password</Button>
                        </CardFooter>
                    </Card>
                </TabsContent>
                <TabsContent Value="tab3">
                    <Card>
                        <CardHeader>
                            <h3 class="text-lg font-semibold leading-none tracking-tight">Settings</h3>
                            <p class="text-sm text-muted-foreground">Configure your preferences.</p>
                        </CardHeader>
                    </Card>
                </TabsContent>
            </Tabs>
        </div>
    </div>

    <!-- Customizer Sidebar — reui.io style -->
    <aside class="w-[280px] shrink-0 border-l border-border/50 sticky top-14 h-[calc(100vh-3.5rem)] overflow-y-auto hidden lg:flex flex-col">
        <!-- Header -->
        <div class="px-4 py-3 border-b border-border/50">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-2">
                    <svg width="16" height="16" viewBox="0 0 32 32" fill="none" class="text-primary">
                        <circle cx="16" cy="16" r="9" fill="none" stroke="currentColor" stroke-width="2" opacity="0.55"/>
                        <circle cx="16" cy="16" r="3" fill="currentColor"/>
                    </svg>
                    <span class="text-sm font-semibold text-foreground">/ create</span>
                </div>
                <Blazicon Svg="Lucide.PanelRightClose" class="h-4 w-4 text-muted-foreground" />
            </div>
            <p class="text-xs text-muted-foreground mt-0.5">Adjust Lumeo styles</p>
        </div>

        <!-- Settings List -->
        <div class="flex-1 overflow-y-auto">
            <!-- Preset -->
            <div class="relative">
                <button class="w-full flex items-center justify-between px-4 py-2.5 hover:bg-accent/40 transition-colors text-left @(_expandedSection == "preset" ? "bg-accent/40" : "")"
                        @onclick='() => ToggleSection("preset")'>
                    <div>
                        <p class="text-[11px] text-muted-foreground leading-none">Preset</p>
                        <p class="text-[13px] font-semibold text-foreground mt-0.5">@GetActivePresetName()</p>
                    </div>
                </button>
                @if (_expandedSection == "preset")
                {
                    <div class="border-y border-border/30 bg-muted/30 py-1 px-2">
                        @foreach (var preset in _presets)
                        {
                            <button class="w-full flex items-center gap-2.5 rounded-md px-2 py-2 text-left hover:bg-accent/50 transition-colors"
                                    @onclick="() => ApplyPreset(preset)">
                                <span class="flex h-4 w-4 shrink-0 items-center justify-center rounded-full border border-muted-foreground/30">
                                    @if (preset.Name == GetActivePresetName())
                                    {
                                        <span class="h-2 w-2 rounded-full bg-foreground"></span>
                                    }
                                </span>
                                <div class="flex-1 min-w-0">
                                    <p class="text-[13px] font-medium text-foreground">@preset.Name</p>
                                    <p class="text-[11px] text-muted-foreground leading-tight">@preset.Description</p>
                                </div>
                                @if (preset.Name == GetActivePresetName())
                                {
                                    <Blazicon Svg="Lucide.Check" class="h-3.5 w-3.5 shrink-0 text-foreground" />
                                }
                            </button>
                        }
                    </div>
                }
            </div>

            <!-- Style -->
            <div class="relative">
                <button class="w-full flex items-center justify-between px-4 py-2.5 hover:bg-accent/40 transition-colors text-left @(_expandedSection == "style" ? "bg-accent/40" : "")"
                        @onclick='() => ToggleSection("style")'>
                    <div>
                        <p class="text-[11px] text-muted-foreground leading-none">Style</p>
                        <p class="text-[13px] font-semibold text-foreground mt-0.5">@(_activeStyle == "new-york" ? "New York" : "Default")</p>
                    </div>
                    <Blazicon Svg="Lucide.Circle" class="h-4 w-4 text-muted-foreground/50" />
                </button>
                @if (_expandedSection == "style")
                {
                    <div class="border-y border-border/30 bg-muted/30 py-1 px-2">
                        @foreach (var style in _styles)
                        {
                            <button class="w-full flex items-center gap-2.5 rounded-md px-2 py-2 text-left hover:bg-accent/50 transition-colors"
                                    @onclick="() => SetStyle(style.Value)">
                                <span class="flex h-4 w-4 shrink-0 items-center justify-center rounded-full border border-muted-foreground/30">
                                    @if (style.Value == _activeStyle)
                                    {
                                        <span class="h-2 w-2 rounded-full bg-foreground"></span>
                                    }
                                </span>
                                <div class="flex-1 min-w-0">
                                    <p class="text-[13px] font-medium text-foreground">@style.Name</p>
                                    <p class="text-[11px] text-muted-foreground leading-tight">@style.Description</p>
                                </div>
                                @if (style.Value == _activeStyle)
                                {
                                    <Blazicon Svg="Lucide.Check" class="h-3.5 w-3.5 shrink-0 text-foreground" />
                                }
                            </button>
                        }
                    </div>
                }
            </div>

            <!-- Base Color -->
            <div class="relative">
                <button class="w-full flex items-center justify-between px-4 py-2.5 hover:bg-accent/40 transition-colors text-left @(_expandedSection == "baseColor" ? "bg-accent/40" : "")"
                        @onclick='() => ToggleSection("baseColor")'>
                    <div>
                        <p class="text-[11px] text-muted-foreground leading-none">Base Color</p>
                        <p class="text-[13px] font-semibold text-foreground mt-0.5">@GetActiveBaseColorName()</p>
                    </div>
                    <span class="h-4 w-4 rounded-full" style="background: @GetActiveBaseColorPreview()"></span>
                </button>
                @if (_expandedSection == "baseColor")
                {
                    <div class="border-y border-border/30 bg-muted/30 py-1 px-2">
                        @foreach (var color in _baseColors)
                        {
                            <button class="w-full flex items-center gap-2.5 rounded-md px-2 py-1.5 text-left hover:bg-accent/50 transition-colors"
                                    @onclick="() => SetBaseColor(color.Value)">
                                <span class="h-3 w-3 rounded-full shrink-0" style="background: @color.Preview"></span>
                                <span class="text-[13px] text-foreground flex-1">@color.Name</span>
                                @if (color.Value == _activeBaseColor)
                                {
                                    <Blazicon Svg="Lucide.Check" class="h-3.5 w-3.5 shrink-0 text-foreground" />
                                }
                            </button>
                        }
                    </div>
                }
            </div>

            <!-- Theme -->
            <div class="relative">
                <button class="w-full flex items-center justify-between px-4 py-2.5 hover:bg-accent/40 transition-colors text-left @(_expandedSection == "theme" ? "bg-accent/40" : "")"
                        @onclick='() => ToggleSection("theme")'>
                    <div>
                        <p class="text-[11px] text-muted-foreground leading-none">Theme</p>
                        <p class="text-[13px] font-semibold text-foreground mt-0.5">@GetActiveThemeName()</p>
                    </div>
                    <span class="h-4 w-4 rounded-full" style="background: @GetActiveThemePreview()"></span>
                </button>
                @if (_expandedSection == "theme")
                {
                    <div class="border-y border-border/30 bg-muted/30 py-1 px-2">
                        @foreach (var theme in _themes)
                        {
                            <button class="w-full flex items-center gap-2.5 rounded-md px-2 py-1.5 text-left hover:bg-accent/50 transition-colors"
                                    @onclick="() => SetTheme(theme.Value)">
                                <span class="h-3 w-3 rounded-full shrink-0" style="background: @theme.Color"></span>
                                <span class="text-[13px] text-foreground flex-1">@theme.Name</span>
                                @if (theme.Value == _activeTheme)
                                {
                                    <Blazicon Svg="Lucide.Check" class="h-3.5 w-3.5 shrink-0 text-foreground" />
                                }
                            </button>
                        }
                    </div>
                }
            </div>

            <!-- Radius -->
            <div class="relative">
                <button class="w-full flex items-center justify-between px-4 py-2.5 hover:bg-accent/40 transition-colors text-left @(_expandedSection == "radius" ? "bg-accent/40" : "")"
                        @onclick='() => ToggleSection("radius")'>
                    <div>
                        <p class="text-[11px] text-muted-foreground leading-none">Radius</p>
                        <p class="text-[13px] font-semibold text-foreground mt-0.5">@GetActiveRadiusName()</p>
                    </div>
                    <span class="inline-flex items-center justify-center h-4 w-4">
                        <span class="h-3.5 w-3.5 border-t-2 border-l-2 border-muted-foreground/50" style="border-radius: @(_activeRadius)rem 0 0 0"></span>
                    </span>
                </button>
                @if (_expandedSection == "radius")
                {
                    <div class="border-y border-border/30 bg-muted/30 py-1 px-2">
                        @foreach (var radius in _radiiOptions)
                        {
                            <button class="w-full flex items-center gap-2.5 rounded-md px-2 py-1.5 text-left hover:bg-accent/50 transition-colors"
                                    @onclick="() => SetRadius(radius.Value)">
                                <span class="inline-flex items-center justify-center h-3.5 w-3.5 shrink-0">
                                    <span class="h-3 w-3 border-t-2 border-l-2 border-muted-foreground/40" style="border-radius: @(radius.Value)rem 0 0 0"></span>
                                </span>
                                <span class="text-[13px] text-foreground flex-1">@radius.Name</span>
                                <span class="text-[11px] text-muted-foreground">@(radius.Value)rem</span>
                                @if (radius.Value == _activeRadius)
                                {
                                    <Blazicon Svg="Lucide.Check" class="h-3.5 w-3.5 shrink-0 text-foreground" />
                                }
                            </button>
                        }
                    </div>
                }
            </div>

            <!-- Mode -->
            <button class="w-full flex items-center justify-between px-4 py-2.5 hover:bg-accent/40 transition-colors text-left"
                    @onclick="ToggleDarkMode">
                <div>
                    <p class="text-[11px] text-muted-foreground leading-none">Mode</p>
                    <p class="text-[13px] font-semibold text-foreground mt-0.5">@(_darkMode ? "Dark" : "Light")</p>
                </div>
                @if (_darkMode)
                {
                    <Blazicon Svg="Lucide.Moon" class="h-4 w-4 text-muted-foreground/50" />
                }
                else
                {
                    <Blazicon Svg="Lucide.Sun" class="h-4 w-4 text-muted-foreground/50" />
                }
            </button>

            <!-- Spacer before actions -->
            <div class="my-1"></div>

            <!-- Shuffle -->
            <button class="w-full flex items-center justify-between px-4 py-2.5 hover:bg-accent/40 transition-colors text-left"
                    @onclick="ShuffleSettings">
                <div>
                    <p class="text-[11px] text-muted-foreground leading-none">Shuffle</p>
                    <p class="text-[13px] font-semibold text-foreground mt-0.5">Try Random</p>
                </div>
                <span class="inline-flex items-center justify-center h-5 w-5 rounded bg-primary text-primary-foreground text-[11px] font-bold">R</span>
            </button>

            <!-- Reset -->
            <button class="w-full flex items-center justify-between px-4 py-2.5 hover:bg-accent/40 transition-colors text-left"
                    @onclick="ResetSettings">
                <div>
                    <p class="text-[11px] text-muted-foreground leading-none">Reset</p>
                    <p class="text-[13px] font-semibold text-foreground mt-0.5">Start Over</p>
                </div>
                <Blazicon Svg="Lucide.RotateCcw" class="h-4 w-4 text-muted-foreground/50" />
            </button>
        </div>

        <!-- Copy Theme — pinned bottom -->
        <div class="px-4 py-3 border-t border-border/50">
            <button class="w-full flex items-center justify-center gap-2 rounded-md bg-primary px-3 py-2 text-sm font-medium text-primary-foreground hover:bg-primary/90 transition-colors"
                    @onclick="CopyTheme">
                @if (_copied)
                {
                    <Blazicon Svg="Lucide.Check" class="h-3.5 w-3.5" />
                    <span>Copied!</span>
                }
                else
                {
                    <Blazicon Svg="Lucide.Copy" class="h-3.5 w-3.5" />
                    <span>Copy Theme</span>
                }
            </button>
        </div>
    </aside>
</div>

@inject IJSRuntime JS

@code {
    private bool _switch1 = true;
    private bool _check1 = true;
    private double _slider1 = 50;
    private bool _bold, _italic, _underline;
    private bool _darkMode;
    private bool _dialogOpen;
    private bool _copied;
    private string _expandedSection = "";

    private string _activeTheme = "";
    private string _activeRadius = "0.75";
    private string _activeStyle = "default";
    private string _activeBaseColor = "slate";

    private record ThemeOption(string Name, string Value, string Color);
    private record StyleOption(string Name, string Value, string Description);
    private record BaseColorOption(string Name, string Value, string Preview);
    private record RadiusOption(string Name, string Value);
    private record PresetOption(string Name, string ThemeValue, string StyleValue, string BaseColorValue, string Preview, string Description);

    private readonly ThemeOption[] _themes =
    [
        new("Orange", "", "hsl(14 70% 50%)"),
        new("Zinc", "zinc", "hsl(240 6% 10%)"),
        new("Blue", "blue", "hsl(221 83% 53%)"),
        new("Green", "green", "hsl(142 71% 45%)"),
        new("Rose", "rose", "hsl(346 77% 50%)"),
    ];

    private readonly StyleOption[] _styles =
    [
        new("Default", "default", "The classic shadcn/ui look. Clean, neutral, and familiar."),
        new("New York", "new-york", "Reduced padding and margins for compact layouts."),
    ];

    private readonly BaseColorOption[] _baseColors =
    [
        new("Slate", "slate", "hsl(215 16% 47%)"),
        new("Gray", "gray", "hsl(220 9% 46%)"),
        new("Zinc", "zinc", "hsl(240 4% 46%)"),
        new("Neutral", "neutral", "hsl(0 0% 45%)"),
        new("Stone", "stone", "hsl(25 5% 45%)"),
    ];

    private readonly RadiusOption[] _radiiOptions =
    [
        new("None", "0"),
        new("Small", "0.25"),
        new("Default", "0.5"),
        new("Medium", "0.75"),
        new("Large", "1"),
    ];

    private readonly PresetOption[] _presets =
    [
        new("Default", "", "default", "slate", "hsl(14 70% 50%)", "Orange / Lucide / Default"),
        new("Minimal", "zinc", "default", "zinc", "hsl(240 6% 10%)", "Zinc / Lucide / Default"),
        new("Vibrant", "blue", "new-york", "slate", "hsl(221 83% 53%)", "Blue / Lucide / New York"),
        new("Warm", "rose", "default", "stone", "hsl(346 77% 50%)", "Rose / Lucide / Default"),
        new("Forest", "green", "default", "gray", "hsl(142 71% 45%)", "Green / Lucide / Default"),
    ];

    private string GetActivePresetName()
    {
        foreach (var p in _presets)
            if (p.ThemeValue == _activeTheme && p.StyleValue == _activeStyle && p.BaseColorValue == _activeBaseColor)
                return p.Name;
        return "Custom";
    }

    private string GetActiveThemeName() => _themes.FirstOrDefault(t => t.Value == _activeTheme)?.Name ?? "Orange";
    private string GetActiveThemePreview() => _themes.FirstOrDefault(t => t.Value == _activeTheme)?.Color ?? "hsl(14 70% 50%)";
    private string GetActiveBaseColorName() => _baseColors.FirstOrDefault(c => c.Value == _activeBaseColor)?.Name ?? "Slate";
    private string GetActiveBaseColorPreview() => _baseColors.FirstOrDefault(c => c.Value == _activeBaseColor)?.Preview ?? "hsl(215 16% 47%)";
    private string GetActiveRadiusName() => _radiiOptions.FirstOrDefault(r => r.Value == _activeRadius)?.Name ?? _activeRadius + "rem";

    private void ToggleSection(string section) => _expandedSection = _expandedSection == section ? "" : section;

    private async Task ApplyPreset(PresetOption preset)
    {
        await SetTheme(preset.ThemeValue);
        await SetStyle(preset.StyleValue);
        await SetBaseColor(preset.BaseColorValue);
        _expandedSection = "";
    }

    private async Task SetStyle(string style)
    {
        _activeStyle = style;
        await JS.InvokeVoidAsync("eval", style == "new-york"
            ? "document.documentElement.classList.add('style-new-york')"
            : "document.documentElement.classList.remove('style-new-york')");
    }

    private async Task SetTheme(string theme)
    {
        _activeTheme = theme;
        await JS.InvokeVoidAsync("eval", string.IsNullOrEmpty(theme)
            ? "document.documentElement.removeAttribute('data-theme')"
            : $"document.documentElement.setAttribute('data-theme', '{theme}')");
    }

    private async Task SetRadius(string radius)
    {
        _activeRadius = radius;
        await JS.InvokeVoidAsync("eval", $"document.documentElement.style.setProperty('--radius', '{radius}rem')");
    }

    private async Task SetBaseColor(string baseColor)
    {
        _activeBaseColor = baseColor;
        await JS.InvokeVoidAsync("eval", $"document.documentElement.setAttribute('data-base-color', '{baseColor}')");
    }

    private async Task ToggleDarkMode()
    {
        _darkMode = !_darkMode;
        await JS.InvokeVoidAsync("eval", _darkMode
            ? "document.documentElement.classList.add('dark')"
            : "document.documentElement.classList.remove('dark')");
    }

    private async Task ShuffleSettings()
    {
        var random = new Random();
        await SetTheme(_themes[random.Next(_themes.Length)].Value);
        await SetRadius(_radiiOptions[random.Next(_radiiOptions.Length)].Value);
        await SetStyle(_styles[random.Next(_styles.Length)].Value);
        await SetBaseColor(_baseColors[random.Next(_baseColors.Length)].Value);
        if (random.Next(2) == 1 != _darkMode) await ToggleDarkMode();
        _expandedSection = "";
    }

    private async Task ResetSettings()
    {
        await SetTheme("");
        await SetRadius("0.75");
        await SetStyle("default");
        await SetBaseColor("slate");
        if (_darkMode) await ToggleDarkMode();
        _expandedSection = "";
    }

    private async Task CopyTheme()
    {
        var parts = new List<string> { "/* Lumeo Theme Configuration */", "@import \"lumeo/css/lumeo.css\";" };
        if (!string.IsNullOrEmpty(_activeTheme)) parts.Add($"/* Theme: {GetActiveThemeName()} */\n@import \"lumeo/css/themes/_{_activeTheme}.css\";");
        parts.Add($"\n:root {{\n  --radius: {_activeRadius}rem;\n}}");
        var css = string.Join("\n", parts);
        await JS.InvokeVoidAsync("eval", $"navigator.clipboard.writeText({System.Text.Json.JsonSerializer.Serialize(css)})");
        _copied = true;
        StateHasChanged();
        await Task.Delay(2000);
        _copied = false;
        StateHasChanged();
    }
}
